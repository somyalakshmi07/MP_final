# Default values for ecommerce-secure
image:
  repository: acrecomsecure.azurecr.io
  tag: latest

# Global settings
namespace: backend
jwtSecret:
  name: jwt-secret
  key: secret

# Azure Cosmos DB (MongoDB API)
mongodb:
  uri: "mongodb+srv://dbuser:Password%40123@cosmos-ecommerce.global.mongocluster.cosmos.azure.com/ecommerce?tls=true&authMechanism=SCRAM-SHA-256&retrywrites=false&maxIdleTimeMS=120000"

# Redis
redis:
  enabled: true
  image: redis:7-alpine
  port: 6379

# Services configuration
services:
  gateway:
    replicas: 2
    port: 3000
    env:
      PORT: "3000"
      AUTH_SERVICE_URL: "http://auth-service:3001"
      CATALOG_SERVICE_URL: "http://catalog-service:3002"
      CART_SERVICE_URL: "http://cart-service:3003"
      ORDER_SERVICE_URL: "http://order-service:3004"
      PAYMENT_SERVICE_URL: "http://payment-service:3005"
      ADMIN_SERVICE_URL: "http://admin-service:3006"

  auth:
    replicas: 2
    port: 3001
    env:
      PORT: "3001"
      REDIS_HOST: "redis"
      REDIS_PORT: "6379"

  catalog:
    replicas: 2
    port: 3002
    env:
      PORT: "3002"

  cart:
    replicas: 2
    port: 3003
    env:
      PORT: "3003"
      REDIS_HOST: "redis"
      REDIS_PORT: "6379"
      CATALOG_SERVICE_URL: "http://catalog-service:3002"

  order:
    replicas: 2
    port: 3004
    env:
      PORT: "3004"
      CART_SERVICE_URL: "http://cart-service:3003"

  payment:
    replicas: 2
    port: 3005
    env:
      PORT: "3005"
      ORDER_SERVICE_URL: "http://order-service:3004"

  admin:
    replicas: 1
    port: 3006
    env:
      PORT: "3006"
      CATALOG_SERVICE_URL: "http://catalog-service:3002"
      ORDER_SERVICE_URL: "http://order-service:3004"

  frontend:
    replicas: 2
    port: 80
    env:
      VITE_API_URL: "http://gateway-service:3000"

# Ingress configuration for Application Gateway
ingress:
  enabled: true
  className: azure/application-gateway
  annotations:
    appgw.ingress.kubernetes.io/ssl-redirect: "true"
  hosts:
    - host: "*"
      paths:
        - path: /
          pathType: Prefix
          backend:
            service:
              name: frontend-service
              port:
                number: 80
        - path: /api
          pathType: Prefix
          backend:
            service:
              name: gateway-service
              port:
                number: 3000

